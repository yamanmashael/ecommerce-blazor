@page "/"
@using Blazor.Services
@using Blazor.Data
<PageTitle>Home - YAMAN-STORE</PageTitle>

<style>
    /* ====== أزرار الكاروسيل (المنتجات) ====== */
    .carousel-btn {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        border: none;
        width: 46px;
        height: 46px;
        border-radius: 999px;
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(6px);
        box-shadow: 0 6px 18px rgba(0, 0, 0, 0.25);
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        z-index: 10;
        transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
    }

        .carousel-btn span {
            font-size: 1.6rem;
            line-height: 1;
            color: #222;
            font-weight: 600;
        }

        .carousel-btn.left {
            left: -10px;
        }

        .carousel-btn.right {
            right: -10px;
        }

        .carousel-btn:hover {
            background: #ffffff;
            transform: translateY(-50%) scale(1.05);
            box-shadow: 0 10px 24px rgba(0, 0, 0, 0.35);
        }

    /* أخفي أزرار الكاروسيل في الموبايل – السحب باللمس يكفي */
    @@media (max-width: 768px) {
        .carousel-btn {
            display: none;
        }
    }

    /* ====== البانر ====== */
    .banner-container {
        position: relative;
        width: 100%;
        height: 65vh;
        overflow: hidden;
        border-radius: 20px;
        box-shadow: 0 18px 40px rgba(0, 0, 0, 0.25);
    }

    .banner-slide {
        position: absolute;
        width: 100%;
        height: 100%;
        opacity: 0;
        transition: opacity 1s ease-in-out;
    }

        .banner-slide.active {
            opacity: 1;
        }

        .banner-slide img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

    /* أسهم البانر – شكل زجاجي بسيط */
    .banner-arrow {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        border: none;
        width: 44px;
        height: 44px;
        border-radius: 999px;
        background: rgba(0, 0, 0, 0.45);
        backdrop-filter: blur(6px);
        box-shadow: 0 10px 28px rgba(0, 0, 0, 0.45);
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        z-index: 5;
        transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
        color: #f9fafb;
    }

        .banner-arrow span {
            font-size: 1.5rem;
            line-height: 1;
            font-weight: 600;
        }

        .banner-arrow.left {
            left: 15px;
        }

        .banner-arrow.right {
            right: 15px;
        }

        .banner-arrow:hover {
            background: rgba(0, 0, 0, 0.75);
            transform: translateY(-50%) scale(1.05);
            box-shadow: 0 14px 36px rgba(0, 0, 0, 0.65);
        }

    /* إخفاء أسهم البانر في الجوال */
    @@media (max-width: 768px) {
        .banner-container {
            height: 45vh;
        }

        .banner-arrow {
            display: none;
        }
    }

    /* ====== البراند ====== */
    .brands-section {
        text-align: center;
        margin: 3rem 0;
    }

        .brands-section h2 {
            font-weight: bold;
            margin-bottom: 1.5rem;
        }

    .brands-list {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 20px;
    }

    .brand-logo {
        width: 120px;
        height: 120px;
        border-radius: 18px;
        object-fit: cover;
        cursor: pointer;
        background: #fff;
        box-shadow: 0 6px 18px rgba(0, 0, 0, 0.12);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

        .brand-logo:hover {
            transform: translateY(-4px) scale(1.03);
            box-shadow: 0 12px 26px rgba(0, 0, 0, 0.2);
        }

    /* ====== المنتجات ====== */
    .products-section {
        margin: 3rem 0;
        position: relative;
        text-align: center;
    }

        .products-section h2 {
            margin-bottom: 1rem;
            font-weight: bold;
        }

    .products-carousel {
        display: flex;
        overflow-x: auto;
        scroll-behavior: smooth;
        gap: 15px;
        padding: 10px;
    }

        .products-carousel::-webkit-scrollbar {
            display: none;
        }

    .product-card {
        flex: 0 0 240px;
        border-radius: 14px;
        overflow: hidden;
        background: #fff;
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        cursor: pointer;
    }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 14px 30px rgba(0, 0, 0, 0.18);
        }

    .product-img {
        width: 100%;
        height: 220px;
        object-fit: cover;
        background: #f3f4f6;
    }

    .product-info {
        text-align: center;
        padding: 0.8rem;
    }

        .product-info p {
            margin: 0.2rem 0;
        }

        .product-info h5 {
            font-size: 1rem;
            margin: 0.3rem 0;
        }

    @@media (max-width: 768px) {
        .product-card {
            flex: 0 0 180px;
        }
    }

    /* ====== الكاتيجوري ====== */
    .categories-section {
        margin: 4rem 0;
        text-align: center;
    }

        .categories-section h2 {
            font-weight: bold;
            margin-bottom: 1.5rem;
        }

    .categories-container {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
    }

    .category-card {
        position: relative;
        overflow: hidden;
        border-radius: 18px;
        cursor: pointer;
        box-shadow: 0 10px 28px rgba(0, 0, 0, 0.16);
    }

        .category-card img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.4s ease;
        }

        .category-card:hover img {
            transform: scale(1.08);
        }

    .category-title {
        position: absolute;
        bottom: 0;
        width: 100%;
        padding: 1rem;
        background: linear-gradient(0deg, rgba(0,0,0,0.75), transparent);
        color: white;
        font-size: 1.4rem;
        font-weight: bold;
        text-align: left;
    }
</style>

<div class="banner-container">
    <div class="banner-slide active"><img src="/images/image1.png" /></div>
    <div class="banner-slide"><img src="/images/image2.png" /></div>
    <div class="banner-slide"><img src="/images/image3.png" /></div>

    <!-- أسهم البانر بشكل جديد -->
    <button type="button" class="banner-arrow left" onclick="moveBanner(-1)">
        <span>&lsaquo;</span>
    </button>
    <button type="button" class="banner-arrow right" onclick="moveBanner(1)">
        <span>&rsaquo;</span>
    </button>
</div>

<section class="brands-section">
    <h2>Shop by Brand</h2>
    <div class="brands-list">
        <img src="/images/adids.png" class="brand-logo" @onclick="() => NavigateToBrand(1045)" />
        <img src="/images/nike.jpg" class="brand-logo" @onclick="() => NavigateToBrand(1046)" />
        <img src="/images/puma.png" class="brand-logo" @onclick="() => NavigateToBrand(1047)" />
        <img src="/images/lacoste.jpg" class="brand-logo" @onclick="() => NavigateToBrand(1048)" />
        <img src="/images/zara.jpg" class="brand-logo" @onclick="() => NavigateToBrand(1049)" />
    </div>
</section>

<section class="products-section">
    <h2>Best Selling Products</h2>

    <button type="button" class="carousel-btn left" onclick="scrollCarousel('popular', -1)">
        <span>&lsaquo;</span>
    </button>
    <button type="button" class="carousel-btn right" onclick="scrollCarousel('popular', 1)">
        <span>&rsaquo;</span>
    </button>

    <div id="popular" class="products-carousel">
        @foreach (var p in popularProduct)
        {
            <div class="product-card" @onclick="() => NavigateToProductDetails(p.ProductId)">
                <img src="@p.productFiltrImagees?.FirstOrDefault()?.ImageFilename" class="product-img" />
                <div class="product-info">
                    <p>@p.BarndName</p>
                    <h5>@p.ProductName</h5>
                    <p>@p.SalesPrice.ToString("C")</p>
                </div>
            </div>
        }
    </div>
</section>

<section class="products-section">
    <h2>New Arrivals</h2>

    <button type="button" class="carousel-btn left" onclick="scrollCarousel('latest', -1)">
        <span>&lsaquo;</span>
    </button>
    <button type="button" class="carousel-btn right" onclick="scrollCarousel('latest', 1)">
        <span>&rsaquo;</span>
    </button>

    <div id="latest" class="products-carousel">
        @foreach (var p in newProduct)
        {
            <div class="product-card" @onclick="() => NavigateToProductDetails(p.ProductId)">
                <img src="@p.productFiltrImagees?.FirstOrDefault()?.ImageFilename" class="product-img" />
                <div class="product-info">
                    <p>@p.BarndName</p>
                    <h5>@p.ProductName</h5>
                    <p>@p.SalesPrice.ToString("C")</p>
                </div>
            </div>
        }
    </div>
</section>

<section class="categories-section">
    <h2>Shop by Category</h2>
    <div class="categories-container">
        <div class="category-card" @onclick="()=>NavigateToCategory(2)">
            <img src="/images/shirt.jpg" />
            <div class="category-title">Men's Fashion</div>
        </div>
        <div class="category-card" @onclick="()=>NavigateToCategory(3)">
            <img src="/images/dress.jpg" />
            <div class="category-title">Women's Fashion</div>
        </div>
        <div class="category-card" @onclick="()=>NavigateToCategory(4)">
            <img src="/images/children.jpg" />
            <div class="category-title">Kids Collection</div>
        </div>
    </div>
</section>

<script>
    (function () {
        let bannerIndex = 0;

        function getSlides() {
            return Array.from(document.querySelectorAll(".banner-slide"));
        }

        window.showBannerSlide = function (i) {
            const slides = getSlides();
            if (slides.length === 0) return;
            const idx = (i + slides.length) % slides.length;
            slides.forEach(s => s.classList.remove("active"));
            slides[idx].classList.add("active");
        };

        window.moveBanner = function (step) {
            const slides = getSlides();
            if (slides.length === 0) return;
            bannerIndex = (bannerIndex + step + slides.length) % slides.length;
            window.showBannerSlide(bannerIndex);
        };

        window.initializeBanner = function () {
            const slides = getSlides();
            if (slides.length === 0) return;
            bannerIndex = 0;
            window.showBannerSlide(bannerIndex);
            if (window.bannerInterval) clearInterval(window.bannerInterval);
            window.bannerInterval = setInterval(() => window.moveBanner(1), 5000);
        };

        document.addEventListener("DOMContentLoaded", window.initializeBanner);
        document.addEventListener("blazor:navigation-end", window.initializeBanner);
    })();

    (function () {
        window.scrollCarousel = function (id, direction) {
            const container = document.getElementById(id);
            if (!container) return;
            const scrollAmount = 260; // عرض الكرت تقريباً
            container.scrollBy({
                left: direction * scrollAmount,
                behavior: 'smooth'
            });
        };
    })();
</script>
